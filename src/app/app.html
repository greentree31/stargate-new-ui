<div class="wrap">
  <h1>{{ title }}</h1>

  <div class="grid">
    <div class="card">
      <h2>People</h2>

      <div *ngIf="loadingPeople">Loading people…</div>

      <ul>
        <li
          *ngFor="let p of people"
          (click)="selectPerson(p)"
          [class.selected]="selectedPerson?.personId === p.personId"
        >
          <div class="name">{{ p.name }}</div>
          <div class="meta">
            {{ p.currentDutyTitle ? (p.currentRank + ' – ' + p.currentDutyTitle) : 'No astronaut duty' }}
          </div>
        </li>
      </ul>
    </div>

    <div class="card" *ngIf="selectedPerson">
      <h2>{{ selectedPerson.name }}</h2>
      <div><strong>Current Rank:</strong> {{ selectedPerson.currentRank || 'N/A' }}</div>
      <div><strong>Current Duty:</strong> {{ selectedPerson.currentDutyTitle || 'N/A' }}</div>

      <div *ngIf="loadingDuties">Loading duties…</div>

      <h3>Duty History</h3>
      <table *ngIf="duties.length > 0">
        <thead>
          <tr><th>Rank</th><th>Duty</th><th>Dates</th></tr>
        </thead>
        <tbody>
          <tr *ngFor="let d of duties">
            <td>{{ d.rank }}</td>
            <td>{{ d.dutyTitle }}</td>
            <td>{{ dutyRange(d) }}</td>
          </tr>
        </tbody>
      </table>

      <div *ngIf="!loadingDuties && duties.length === 0">No duties found.</div>
    </div>
  </div>

  <div class="error" *ngIf="errorMessage">{{ errorMessage }}</div>
</div>
